---
phase: 02-rsvp-playback-engine
plan: 03
type: execute
wave: 2
depends_on:
  - 02-01
  - 02-02
files_modified:
  - src/components/RSVPReader/ORPDisplay.tsx
  - src/components/RSVPReader/ProgressBar.tsx
autonomous: true
requirements:
  - RSVP-01
  - RSVP-04

must_haves:
  truths:
    - "ORPDisplay renders a word as three spans in a fixed-width CSS grid — left fragment (right-aligned), red focal character, right fragment (left-aligned)"
    - "The focal character column does not shift horizontally as words change — fixed-width grid columns guarantee this"
    - "ORPDisplay uses a monospace font at ~4-6rem — making the reading display large and prominent"
    - "The word display sits on a dark background panel (per user decision from CONTEXT.md)"
    - "ProgressBar displays 'Word 142 / 3,420 (45%)' format — absolute position + percentage (per user decision)"
    - "ProgressBar sits above the word display panel (per user decision)"
  artifacts:
    - path: "src/components/RSVPReader/ORPDisplay.tsx"
      provides: "Three-span ORP word display with fixed focal character column position"
      exports: ["ORPDisplay"]
      contains: "computeOrp"
    - path: "src/components/RSVPReader/ProgressBar.tsx"
      provides: "Progress indicator showing 'Word X / Y (Z%)' format"
      exports: ["ProgressBar"]
  key_links:
    - from: "src/components/RSVPReader/ORPDisplay.tsx"
      to: "src/lib/orp.ts"
      via: "import { computeOrp } from '../../lib/orp'"
      pattern: "computeOrp"
    - from: "src/components/RSVPReader/ProgressBar.tsx"
      to: "src/store/rsvp-store.ts"
      via: "import { useRsvpStore } from '../../store/rsvp-store'"
      pattern: "currentWordIndex"
---

<objective>
Build the two pure display components for the RSVP reading screen:

1. `ORPDisplay` — renders one word as three spans in a fixed CSS grid, focal character always at the same horizontal pixel position. Uses computeOrp from 02-01. Monospace font, dark panel background, ~4.5rem font size. This is the hero visual for the entire app.

2. `ProgressBar` — displays the current reading position in "Word 142 / 3,420 (45%)" format above the word display. Reads from the Zustand store (currentWordIndex + wordList.length).

Purpose: These are standalone display components with no scheduler or playback logic. Separating them from the playback assembly (Plan 05) allows parallel execution with PlaybackControls (Plan 04).

Output: `src/components/RSVPReader/ORPDisplay.tsx`, `src/components/RSVPReader/ProgressBar.tsx`
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/02-rsvp-playback-engine/02-CONTEXT.md
@.planning/phases/02-rsvp-playback-engine/02-RESEARCH.md
@.planning/phases/02-rsvp-playback-engine/02-01-SUMMARY.md
@.planning/phases/02-rsvp-playback-engine/02-02-SUMMARY.md
@src/lib/orp.ts
@src/store/rsvp-store.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ORPDisplay component — fixed focal character column display</name>
  <files>src/components/RSVPReader/ORPDisplay.tsx</files>
  <action>
    Create directory `src/components/RSVPReader/` (if not exists).

    Create `src/components/RSVPReader/ORPDisplay.tsx`:

    ```tsx
    import { computeOrp } from '../../lib/orp'

    interface ORPDisplayProps {
      word: string
    }

    export function ORPDisplay({ word }: ORPDisplayProps) {
      const { left, focal, right } = computeOrp(word)
      return (
        <div
          className="font-mono flex items-center justify-center"
          // Dark panel: bg-gray-900, padding, rounded corners
          // Claude's discretion: border-radius 1rem, padding 2rem 3rem
        >
          <div
            style={{
              display: 'grid',
              gridTemplateColumns: '14ch 1ch 20ch',
              fontSize: '4.5rem',
              lineHeight: 1,
            }}
            className="font-mono items-center"
          >
            <span className="text-right text-white select-none">{left}</span>
            <span className="text-red-500 select-none">{focal}</span>
            <span className="text-left text-white select-none">{right}</span>
          </div>
        </div>
      )
    }
    ```

    Key implementation constraints:
    - Grid column widths: `14ch 1ch 20ch` — left column right-aligned, focal center (1ch), right column left-aligned. 35ch total capacity handles 20+ character words in English. This is Claude's discretion per RESEARCH.md.
    - Font: `font-mono` — required for stable column width (every char exactly 1ch). Never use a proportional font.
    - Font size: `4.5rem` — within the locked 4-6rem range from CONTEXT.md.
    - Dark panel: The dark background card/panel is specified in CONTEXT.md as a user decision. Wrap the grid inside a dark container `bg-gray-900` with generous padding (py-10 px-12) and rounded-2xl. Do NOT use white or light backgrounds.
    - Fragment colors: left/right spans are `text-white`, focal span is `text-red-500`. No bold variation between fragments per CONTEXT.md ("left/right fragments shown at full weight, only color distinguishes focal").
    - `select-none` on spans to prevent accidental text selection during reading.
    - Handle empty word: if `word` is empty string, `computeOrp` returns empty strings — all spans render empty (blank panel, correct behavior at start/end of word list).

    Do NOT put the dark panel in ORPDisplay itself — instead, wrap the entire grid + any outer styling. The component is the full dark-panel display unit.

    After creation, run TypeScript check: `nvm use 22 && npx tsc --noEmit`
  </action>
  <verify>
    <automated>cd /Users/nousunio/Repos/Learnings/claude-code/rsvp-reader-pwa && nvm use 22 && npx tsc --noEmit 2>&1 | head -10</automated>
    <manual>File exists at src/components/RSVPReader/ORPDisplay.tsx. No TS errors.</manual>
  </verify>
  <done>ORPDisplay.tsx exists, imports computeOrp, renders three spans in fixed-width CSS grid, uses font-mono, 4.5rem size, dark background, red focal. TypeScript clean.</done>
</task>

<task type="auto">
  <name>Task 2: Create ProgressBar component — reading position display</name>
  <files>src/components/RSVPReader/ProgressBar.tsx</files>
  <action>
    Create `src/components/RSVPReader/ProgressBar.tsx`:

    The component reads directly from Zustand store (not props) — it always shows the live current position.

    ```tsx
    import { useRsvpStore } from '../../store/rsvp-store'

    export function ProgressBar() {
      const currentWordIndex = useRsvpStore((s) => s.currentWordIndex)
      const wordList = useRsvpStore((s) => s.wordList)
      const total = wordList.length

      if (total === 0) {
        return null  // Don't render when no document loaded
      }

      // Display is 1-indexed for human readability: "Word 1 / 100" not "Word 0 / 100"
      const displayIndex = currentWordIndex + 1
      const pct = Math.round((currentWordIndex / Math.max(1, total - 1)) * 100)

      return (
        <div className="text-sm text-gray-400 text-center tabular-nums">
          Word {displayIndex.toLocaleString()} / {total.toLocaleString()} ({pct}%)
        </div>
      )
    }
    ```

    Key implementation constraints:
    - Format: "Word 142 / 3,420 (45%)" — this is a LOCKED user decision from CONTEXT.md. Use `toLocaleString()` for number formatting (comma separators).
    - 1-indexed display: `displayIndex = currentWordIndex + 1` so first word shows "Word 1 / N" not "Word 0 / N".
    - Percentage calculation: `Math.round((currentWordIndex / Math.max(1, total - 1)) * 100)` — avoids division by zero, 100% when at last word.
    - `tabular-nums` Tailwind class: prevents digits from jumping width as numbers change during playback.
    - Color: `text-gray-400` — progress indicator is secondary, not the focal element.
    - Returns null when total === 0 (no document loaded) — clean empty state.

    After creation, run TypeScript check.
    Commit both components: `feat(02-03): add ORPDisplay and ProgressBar components`
  </action>
  <verify>
    <automated>cd /Users/nousunio/Repos/Learnings/claude-code/rsvp-reader-pwa && nvm use 22 && npx tsc --noEmit 2>&1 | head -10</automated>
    <manual>File exists at src/components/RSVPReader/ProgressBar.tsx. No TS errors. Format string matches "Word X / Y (Z%)" with comma-formatted numbers.</manual>
  </verify>
  <done>ProgressBar.tsx exists, reads currentWordIndex and wordList from Zustand, renders "Word X / Y (Z%)" format with toLocaleString. TypeScript clean. Both components committed.</done>
</task>

</tasks>

<verification>
TypeScript check: `nvm use 22 && npx tsc --noEmit` — 0 errors.
Both files exist: `ls src/components/RSVPReader/`
ORPDisplay uses `computeOrp` from `../../lib/orp`, grid layout with `14ch 1ch 20ch` columns, font-mono, text-red-500 on focal span.
ProgressBar uses `useRsvpStore`, displays `toLocaleString()` formatted numbers, handles total=0 with null return.
</verification>

<success_criteria>
- ORPDisplay renders left/focal/right in a fixed-width CSS grid (focal character always at same horizontal position)
- Monospace font, 4.5rem, dark panel background (bg-gray-900), red focal character (text-red-500)
- ProgressBar shows "Word X / Y (Z%)" with comma-formatted numbers
- Both components are TypeScript-clean and production-build ready
- No proportional fonts, no centering tricks that shift the focal column
</success_criteria>

<output>
After completion, create `.planning/phases/02-rsvp-playback-engine/02-03-SUMMARY.md`
</output>
