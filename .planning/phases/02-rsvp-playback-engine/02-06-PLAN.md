---
phase: 02-rsvp-playback-engine
plan: 06
type: execute
wave: 4
depends_on:
  - 02-05
files_modified: []
autonomous: false
requirements:
  - RSVP-01
  - RSVP-02
  - RSVP-03
  - RSVP-04
  - CTRL-01
  - CTRL-02
  - CTRL-03
  - CTRL-04

must_haves:
  truths:
    - "Human confirms: red focal character holds the same horizontal screen position across all words (including single-char 'I' and long words like 'transformation')"
    - "Human confirms: WPM slider adjusts speed live mid-session without restarting playback"
    - "Human confirms: sentence-ending words produce a perceptible pause before the next word advances"
    - "Human confirms: progress display updates on every word change (Word X / Y (Z%) visible)"
    - "Human confirms: pause/resume and jump controls work; keyboard Space/ArrowLeft/ArrowRight function correctly"
  artifacts:
    - path: ".planning/phases/02-rsvp-playback-engine/02-06-SUMMARY.md"
      provides: "Human verification record for Phase 2"
  key_links: []
---

<objective>
Human verification of the complete Phase 2 RSVP Playback Engine against all five success criteria from ROADMAP.md.

This checkpoint pauses for the user to run the production preview, navigate through the full RSVP reading experience with a real document, and confirm each success criterion.

Purpose: Phase 2 is only "complete" when a human has verified the reading experience actually works — automated tests prove the functions work, but cannot verify that the focal character visually stays put, that sentence pauses feel natural, or that keyboard controls respond correctly.

Output: Human approval or list of issues to fix.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/phases/02-rsvp-playback-engine/02-05-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Run production build and start preview server</name>
  <files></files>
  <action>
    Run production build and start preview server for human verification:

    ```bash
    nvm use 22 && npm run build && npm run preview
    ```

    The preview server starts at http://localhost:4173 (default Vite preview port).

    Also run the full lib test suite one final time to confirm no regressions:
    ```bash
    nvm use 22 && npx vitest run src/lib/
    ```

    Report:
    - Build status (exit code)
    - Test results (pass/fail count)
    - Preview URL
    - Brief instructions for the human verifier (what to do in the app)
  </action>
  <verify>
    <automated>cd /Users/nousunio/Repos/Learnings/claude-code/rsvp-reader-pwa && nvm use 22 && npm run build 2>&1 | tail -5 && nvm use 22 && npx vitest run src/lib/ 2>&1 | tail -5</automated>
    <manual>Build exits 0. All lib tests pass.</manual>
  </verify>
  <done>Production build complete. Preview server running. All automated tests pass. Human verifier can proceed to the checkpoint.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Human verification of all five Phase 2 success criteria</name>
  <files></files>
  <action>Human verifies all five Phase 2 success criteria at http://localhost:4173 per the how-to-verify instructions below.</action>
  <verify>Human types "approved" after confirming all five criteria pass.</verify>
  <done>All five Phase 2 success criteria from ROADMAP.md confirmed by human. Phase 2 declared complete.</done>
  <what-built>
    Complete RSVP Playback Engine at /read:
    - Three-span ORP display: left fragment / red focal character / right fragment in a fixed CSS grid (focal always same horizontal position)
    - performance.now() deadline scheduler — drift-free word timing
    - Word-length normalization (short words faster, long words slower)
    - Sentence-pause multiplier (1.5× delay on words ending in . ! ?)
    - Progress display: "Word X / Y (Z%)" above the word panel
    - Controls: << jump-back, [-N+] jump-size stepper, play/pause, >> jump-forward, WPM slider (50-1000), preset buttons [200][300][500]
    - WPM persists to localStorage (survives page refresh)
    - Keyboard shortcuts: Space = pause/resume, ArrowLeft = jump back, ArrowRight = jump forward
    - Background tab auto-pause (visibilitychange)
    - Playback stops at last word
  </what-built>
  <how-to-verify>
    Open http://localhost:4173 in Chrome or Firefox.

    **Setup — load content:**
    1. Paste a paragraph of text (2-4 sentences, 50-100 words) into the paste area on the entry screen
    2. Click "Start Reading" on the TextPreview screen
    3. Confirm you arrive at the RSVP reading screen (/read)

    **Criterion 1 — ORP focal character position (RSVP-01):**
    4. Press play
    5. Watch 10-20 words flash by — the red character should appear anchored to the same horizontal pixel column for every word
    6. Pause. Navigate to a single-character word (use ArrowLeft/Right) — verify "I", "a" still show the red char in the same column as longer words
    7. PASS: Red character position is visually stable. FAIL: Red char drifts left/right between words.

    **Criterion 2 — WPM slider adjusts live (CTRL-01):**
    8. Start playback at default speed (250 WPM)
    9. While playing, drag the slider to 500 WPM — words should noticeably speed up on the next word
    10. Drag back to 100 WPM — words should slow down noticeably
    11. PASS: Speed change is immediate (next word) without restarting from the beginning. FAIL: Speed appears stuck or resets to word 1.

    **Criterion 3 — Sentence pause (RSVP-02):**
    12. Use text that includes sentence-ending periods (e.g., "The cat sat. The dog ran.")
    13. Watch playback — words before a new sentence should feel like they linger slightly longer
    14. PASS: Perceptible pause after sentence-ending words. FAIL: All words advance at identical speed regardless of punctuation.

    **Criterion 4 — Progress indicator (RSVP-04):**
    15. Confirm the progress row ("Word X / Y (Z%)") is visible above the word panel
    16. While playing, verify it updates on every word change
    17. Jump forward with ArrowRight — verify progress jumps to the new position
    18. PASS: Progress shows correct position and updates live. FAIL: Progress is static or shows wrong numbers.

    **Criterion 5 — Controls and keyboard shortcuts (CTRL-02, CTRL-03, CTRL-04):**
    19. Space bar: press to pause (confirm playback stops), press again to resume (confirm playback continues from same word)
    20. ArrowLeft: press 3x while paused — confirm word index goes back by 30 (3 × 10-word jump)
    21. ArrowRight: press 3x — confirm word index goes forward by 30
    22. On-screen << and >> buttons: same behavior as arrow keys
    23. Preset buttons [200] [300] [500]: click each — verify WPM display and slider position update
    24. Reload page — verify WPM is restored from localStorage (same speed as last session)
    25. PASS: All controls responsive, keyboard shortcuts work, WPM persists. FAIL: Any control is unresponsive or WPM resets to 250 on reload.

    **Bonus checks:**
    - Switch to a different browser tab while playing — confirm playback auto-pauses
    - Return to the tab — confirm it is paused (no word burst)
  </how-to-verify>
  <resume-signal>Type "approved" if all 5 criteria pass. Otherwise describe which criteria failed and what you observed.</resume-signal>
</task>

</tasks>

<verification>
All five Phase 2 success criteria from ROADMAP.md confirmed by human:
1. ORP focal character position visually stable across all word lengths
2. WPM slider adjusts speed live without restarting
3. Sentence-ending words produce perceptible pause
4. Progress indicator updates on every word change
5. Pause/resume/jump controls + keyboard shortcuts all work; WPM persists across reload
</verification>

<success_criteria>
Human has typed "approved" confirming all five success criteria from ROADMAP.md Phase 2 pass.
Phase 2 — RSVP Playback Engine is complete and human-verified.
</success_criteria>

<output>
After completion, create `.planning/phases/02-rsvp-playback-engine/02-06-SUMMARY.md` marking Phase 2 as human-verified complete.
Update .planning/STATE.md: Phase 2 complete, Phase 3 unblocked.
Update .planning/ROADMAP.md: Phase 2 complete with date.
</output>
