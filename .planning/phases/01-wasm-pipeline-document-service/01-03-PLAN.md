---
phase: 01-wasm-pipeline-document-service
plan: "03"
type: execute
wave: 2
depends_on:
  - "01-01"
files_modified:
  - src/store/rsvp-store.ts
  - src/App.tsx
autonomous: true
requirements:
  - IMPT-04
  - DOCF-01

must_haves:
  truths:
    - "Zustand store holds wordList, documentTitle, and currentWordIndex — accessible from any component"
    - "App.tsx routes between EntryScreen, TextPreview, and RSVPPlaceholder using React Router"
    - "Back navigation from any screen returns to EntryScreen without destroying it"
    - "npm run dev starts with no TypeScript errors"
  artifacts:
    - path: "src/store/rsvp-store.ts"
      provides: "Zustand store with wordList, documentTitle, setDocument, reset actions"
      contains: "wordList"
    - path: "src/App.tsx"
      provides: "React Router routes for /, /preview, /read"
      contains: "Routes"
  key_links:
    - from: "src/App.tsx"
      to: "src/store/rsvp-store.ts"
      via: "DocumentService sets store; EntryScreen reads isWorkerReady from store"
      pattern: "useRsvpStore"
    - from: "src/App.tsx"
      to: "src/components/EntryScreen/EntryScreen.tsx"
      via: "Route path=/ renders EntryScreen"
      pattern: "path.*/"
---

<objective>
Wire up the Zustand state store and React Router routing layer. Establishes the app shell that EntryScreen, TextPreview, and RSVPPlaceholder will plug into. Runs in parallel with Plan 02 (spike) since it has no dependency on WASM results.

Purpose: EntryScreen (Plan 04) needs both the store (to write parsed words) and routing (to navigate to /preview). Both depend on the scaffold from Plan 01 but are independent of the spike.

Output: A minimal Zustand store with the Phase 1 data shape, and an App.tsx with three routes wired to placeholder components that Plan 04 will replace.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-wasm-pipeline-document-service/01-RESEARCH.md
@.planning/phases/01-wasm-pipeline-document-service/01-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Zustand store with Phase 1 data shape</name>
  <files>
    src/store/rsvp-store.ts
  </files>
  <action>
Install React Router (needed for App.tsx routing):
```bash
npm install react-router-dom
```

Create `src/store/rsvp-store.ts`:

```typescript
import { create } from 'zustand'

/**
 * Phase 1 store — minimal shape for document pipeline.
 * Phase 2 will add currentWordIndex, wpm, isPlaying.
 * Phase 3 will add imports from View components.
 */
interface RsvpStore {
  // Document state
  wordList: string[]
  documentTitle: string | null

  // Worker readiness — import button disabled until true
  isWorkerReady: boolean

  // Actions
  setDocument: (words: string[], title: string | null) => void
  setWorkerReady: (ready: boolean) => void
  reset: () => void
}

const initialState = {
  wordList: [],
  documentTitle: null,
  isWorkerReady: false,
}

export const useRsvpStore = create<RsvpStore>((set) => ({
  ...initialState,

  setDocument: (words, title) =>
    set({ wordList: words, documentTitle: title }),

  setWorkerReady: (ready) =>
    set({ isWorkerReady: ready }),

  reset: () => set(initialState),
}))
```
  </action>
  <verify>
Run `npm run build` (or `tsc --noEmit`) — no TypeScript errors in rsvp-store.ts. The store exports `useRsvpStore` as a named export.
  </verify>
  <done>
`src/store/rsvp-store.ts` exists, exports `useRsvpStore`, has `wordList`, `documentTitle`, `isWorkerReady`, `setDocument`, `setWorkerReady`, `reset`. TypeScript compiles without errors.
  </done>
</task>

<task type="auto">
  <name>Task 2: Wire App.tsx with React Router routes and placeholder screens</name>
  <files>
    src/App.tsx
  </files>
  <action>
Replace `src/App.tsx` with the full routing shell. Uses React Router v7 (installed in Task 1). Creates inline placeholder components for TextPreview and RSVPPlaceholder — these will be replaced by dedicated component files in Plan 04.

```typescript
import React from 'react'
import { BrowserRouter, Routes, Route, useNavigate } from 'react-router-dom'

// ── Placeholder screens ────────────────────────────────────────────────────────
// These stubs make the phase end-to-end testable.
// Plan 04 replaces them with full component files.

function TextPreviewPlaceholder() {
  const navigate = useNavigate()
  return (
    <div className="min-h-screen bg-white dark:bg-gray-950 flex flex-col items-center justify-center p-4">
      <h1 className="text-2xl font-semibold text-gray-800 dark:text-gray-100 mb-2">
        Text Preview
      </h1>
      <p className="text-sm text-gray-500 mb-6">
        (Placeholder — replaced in Plan 04)
      </p>
      <div className="flex gap-3">
        <button
          onClick={() => navigate('/')}
          className="px-4 py-2 text-sm text-gray-600 dark:text-gray-400 border border-gray-300 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800"
        >
          Back
        </button>
        <button
          onClick={() => navigate('/read')}
          className="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700"
        >
          Start Reading
        </button>
      </div>
    </div>
  )
}

function RSVPPlaceholder() {
  const navigate = useNavigate()
  return (
    <div className="min-h-screen bg-white dark:bg-gray-950 flex flex-col items-center justify-center p-4">
      <h1 className="text-2xl font-semibold text-gray-800 dark:text-gray-100 mb-2">
        RSVP Reader
      </h1>
      <p className="text-sm text-gray-500 mb-2">
        (Placeholder — RSVP engine built in Phase 2)
      </p>
      <button
        onClick={() => navigate('/')}
        className="mt-4 px-4 py-2 text-sm text-gray-600 dark:text-gray-400 border border-gray-300 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800"
      >
        Back to Home
      </button>
    </div>
  )
}

// ── Entry screen import (Plan 04 creates the real component) ──────────────────
// Lazy-import so this compiles before EntryScreen.tsx exists.
// Replace with: import EntryScreen from './components/EntryScreen/EntryScreen'
// once Plan 04 is complete.
function EntryScreenPlaceholder() {
  return (
    <div className="min-h-screen bg-white dark:bg-gray-950 flex flex-col items-center justify-center p-4">
      <h1 className="text-3xl font-bold text-gray-800 dark:text-gray-100 mb-2">
        RSVP Reader
      </h1>
      <p className="text-sm text-gray-500">Import entry screen (built in Plan 04)</p>
    </div>
  )
}

// ── App shell ─────────────────────────────────────────────────────────────────
export default function App() {
  return (
    <BrowserRouter>
      <Routes>
        {/*
          Route: Entry screen
          EntryScreenPlaceholder is swapped for real EntryScreen in Plan 04.
          The entry screen is NOT destroyed on navigation — React Router's default
          unmount/remount behavior is fine here; Phase 1 has no persisted state to lose.
        */}
        <Route path="/" element={<EntryScreenPlaceholder />} />

        {/*
          Route: Text preview
          Shows extracted text + word count before RSVP starts.
        */}
        <Route path="/preview" element={<TextPreviewPlaceholder />} />

        {/*
          Route: RSVP reader (placeholder for Phase 1)
          Phase 2 replaces this with the real RSVP engine.
        */}
        <Route path="/read" element={<RSVPPlaceholder />} />
      </Routes>
    </BrowserRouter>
  )
}
```
  </action>
  <verify>
Run `npm run dev` and navigate to:
- http://localhost:5173/ — shows Entry Screen placeholder
- http://localhost:5173/preview — shows Text Preview placeholder with Back + Start Reading buttons
- http://localhost:5173/read — shows RSVP placeholder with Back to Home button
- Clicking Back buttons navigates back to / correctly
- No TypeScript errors in console.
  </verify>
  <done>
App.tsx uses BrowserRouter with three routes: /, /preview, /read. All three render placeholder components. Navigation between routes works via buttons. `npm run dev` runs without errors.
  </done>
</task>

</tasks>

<verification>
1. `npm run dev` — no errors, three routes accessible
2. Navigating / → /preview → /read → / works via in-page buttons
3. `src/store/rsvp-store.ts` — exports useRsvpStore with wordList, setDocument, setWorkerReady, reset
4. `npm run build` (or `tsc --noEmit`) — no TypeScript errors across store and App.tsx
5. react-router-dom appears in package.json dependencies
</verification>

<success_criteria>
- Zustand store compiled and typed with Phase 1 data shape
- Three routes (/, /preview, /read) work in dev
- App.tsx structure is ready for Plan 04 to swap placeholder components for real screens
- No TypeScript errors
</success_criteria>

<output>
After completion, create `/Users/nousunio/Repos/Learnings/claude-code/text-to-voice/.planning/phases/01-wasm-pipeline-document-service/01-03-SUMMARY.md`
</output>
